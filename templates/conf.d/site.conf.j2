{% for server in item.value.servers %}
{% if not server.disabled is defined or not server.disabled | bool %}
server {
{% if server.options is defined %}
{% for key, value in server.options.items() %}
{% if value is none or value | length < 1 %}
  {{ key }};
{% elif value | length == value | string | length %}
  {{ key }} {{ value }};
{% else %}
{% for value_entry in value %}
{% if value_entry | length < 1 %}
  {{ key }};
{% else %}
  {{ key }} {{ value_entry }};
{% endif %}
{% endfor %}
{% endif %}
{% endfor %}
{% endif %}
{% if server.locations is defined %}
{% for location_key, location_value in server.locations.items() %}
  location {{ location_key }} {
{% if location_value is defined %}
{% for key, value in location_value.items() %}
{% if value is none or value | length < 1 %}
    {{ key }};
{% elif value | length == value | string | length %}
    {{ key }} {{ value }};
{% else %}
{% for value_entry in value %}
{% if value_entry is none or value_entry | length < 1 %}
    {{ key }};
{% else %}
    {{ key }} {{ value_entry }};
{% endif %}
{% endfor %}
{% endif %}
{% endfor %}
{% endif %}
  }
{% endfor %}
{% endif %}
}
{% endif %}
{% endfor %}
